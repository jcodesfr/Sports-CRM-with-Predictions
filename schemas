from pydantic import BaseModel
from typing import Optional, List

# ---- Teams
class TeamCreate(BaseModel):
    name: str
    league: Optional[str] = None

class TeamOut(BaseModel):
    id: int
    name: str
    league: Optional[str] = None
    class Config:
        from_attributes = True

# ---- Players
class PlayerCreate(BaseModel):
    name: str
    position: Optional[str] = None
    team_id: Optional[int] = None

class PlayerOut(BaseModel):
    id: int
    name: str
    position: Optional[str] = None
    team_id: Optional[int] = None
    class Config:
        from_attributes = True

# ---- Fixtures
class FixtureCreate(BaseModel):
    team_id: int
    opponent: str
    date: str  # "YYYY-MM-DD"
    venue: Optional[str] = None
    stage: Optional[str] = "Upcoming"

class FixtureOut(BaseModel):
    id: int
    team_id: int
    opponent: str
    date: str
    venue: Optional[str] = None
    stage: str
    class Config:
        from_attributes = True

# ---- Predictions
class PredictionCreate(BaseModel):
    fixture_id: int
    player_id: int
    metric: str
    value: float
    model: Optional[str] = None

class PredictionOut(BaseModel):
    id: int
    fixture_id: int
    player_id: int
    metric: str
    value: float
    model: Optional[str] = None
    class Config:
        from_attributes = True

# ---- Predict endpoint (input for quick baseline)
class PredictRequestItem(BaseModel):
    player_id: int
    metric: str = "points"
    recent_values: list[float]  # e.g., last N game stats for that metric

class PredictRequest(BaseModel):
    fixture_id: int
    items: List[PredictRequestItem]

class PredictResponseItem(BaseModel):
    player_id: int
    metric: str
    value: float
    model: str = "naive_mean_v1"

class PredictResponse(BaseModel):
    predictions: List[PredictResponseItem]
